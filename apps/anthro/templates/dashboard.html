{% extends "base.html" %}
{% block content %}
<div class="d-flex align-items-center justify-content-between mb-3">
  <h1 class="h4 mb-0"><i class="bi bi-speedometer2 me-1"></i>{{ t.dashboard }}</h1>
  <div class="d-flex gap-2">
    <a class="btn btn-outline-primary" href="{{ url_for('download_template') }}">
      <i class="bi bi-filetype-xlsx me-1"></i>{{ t.download_template }}
    </a>

    <form class="d-inline" action="{{ url_for('upload_excel') }}" method="post" enctype="multipart/form-data">
      <label class="btn btn-primary btn-sm mb-0">
        <i class="bi bi-cloud-upload me-1"></i>{{ t.upload_excel }}
        <input type="file" name="file" accept=".xlsx,.xls" hidden onchange="this.form.submit()">
      </label>
    </form>
  </div>
</div>

<div class="card shadow-sm border-0">
  <div class="card-body p-0">
    {% if uploads %}
      <div class="table-responsive">
        <table class="table table-hover align-middle mb-0">
          <thead class="table-light">
            <tr>
              <th>#</th>
              <th>Fájl</th>
              <th>Dátum</th>
              <th class="text-end">Letöltések</th>
            </tr>
          </thead>
          <tbody>
            {% for u in uploads %}
            <tr>
              <td>{{ loop.index }}</td>
              <td><a href="{{ url_for('view_upload', upload_id=u.id) }}" class="text-decoration-none">{{ u.original_filename }}</a></td>
              <td>{{ u.created_at.strftime('%Y-%m-%d %H:%M') if u.created_at else '' }}</td>
              <td class="text-end">
                <a class="btn btn-sm btn-outline-success" href="{{ url_for('export_upload_xlsx', upload_id=u.id) }}"><i class="bi bi-filetype-xlsx me-1"></i>{{ t.results_xlsx }}</a>
                <a class="btn btn-sm btn-outline-danger" href="{{ url_for('export_upload_pdfs', upload_id=u.id) }}"><i class="bi bi-filetype-pdf me-1"></i>{{ t.results_pdfs }}</a>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <div class="p-4 text-center text-secondary">
        <i class="bi bi-cloud-arrow-up display-6 d-block mb-2"></i>
        Még nincs feltöltött fájlod.
      </div>
    {% endif %}
  </div>
</div>
{% endblock %}
